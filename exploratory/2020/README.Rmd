---
title: "Exploratory Plots"
date: "5/27/2020"
output: 
  github_document:
    html_preview: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      fig.path = "figures/"
                      )
```
```{r lib}
library(here)
library(tidyverse)
theme_set(theme_classic())
color_palette <- RColorBrewer::brewer.pal(4, "Dark2")
dataset_colors <- list(human = color_palette[[3]],
                       marine = color_palette[[1]],
                       mouse = color_palette[[4]],
                       soil = color_palette[[2]]
                       )
```

# Fitting datasets to a reference database vs _de novo_ clustering
```{r functions}
relevel_method <- function(df) {
  df %>%
    mutate(method = fct_relevel(method, c("open", "closed", "de_novo")))
}
plot_jitter <- function(.df, ...) {
  .df %>% 
    ggplot(aes(...)) +
    geom_jitter() +
    scale_color_manual(values=dataset_colors)
}
```

```{r fit_db_sensspec}
sensspec <- read_tsv(here('subworkflows/2_fit_reference_db/results/sensspec.txt')) %>% 
  relevel_method()
sensspec %>% 
  group_by(dataset, method) %>% 
  plot_jitter(x = method, y = mcc, color = dataset) +
  ylim(0, 1)
```

```{r fit_db_benchmarks}
benchmarks <- read_tsv(here('subworkflows/2_fit_reference_db/results/benchmarks.txt')) %>% 
  relevel_method
benchmarks %>% 
  group_by(dataset, method) %>% 
  plot_jitter(x = method, y = s, color = dataset) +
  labs(y='seconds')
```

```{r fit_db_input_size}

```


```{r fraction_reads_mapped}
fractions <- read_tsv(here('subworkflows/2_fit_reference_db/results/fraction_reads_mapped.txt'))
fractions %>% 
  plot_jitter(x=dataset, y=fraction_mapped, color=dataset) +
  ylim(0, 1)
```






```{r render, echo=FALSE, eval=FALSE}
rmarkdown::render(here::here("exploratory/2020/README.Rmd"), 
                  output_dir = "exploratory/2020/")
```

